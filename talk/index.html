<!doctype html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Control Over Image Animation</title>
<link rel="shortcut icon" href="assets/hamu.gif">
<script src="webslides.js"></script>
<link rel="stylesheet" href="webslides.css">
<link rel="stylesheet" href="webslides-basic-theme.css">

<script src="prism.js"></script>
<link rel="stylesheet" href="prism-light.css">

<link rel="stylesheet" href="style.css">

<section id=cover>
	<heading>
	<h1>Control Over Image Animation</h1>
	</heading>
</section>

<section id=what>
	<h2>Animated Images</h2>
	<ul data-reveal>
		<li>Animated GIFs
		<li>APNG
		<li>WebP
		<li>…
		<li>They are everywhere, and here to stay
	</ul>
</section>

<style>
#hamster p {
	max-width: 780px;
}
</style>
<section id=hamster>
	<h2>Classics</h2>
<center><p>
	<img src="assets/anin.gif" alt="HUGO, BRIAN THE HAMSTER, JUSTINA"><img src="assets/anin.gif" alt="TWISTER"><img src="assets/anin.gif" alt="FATTY BOOM BOOM"><img src="assets/anin.gif"><img src="assets/anin.gif">
<img src="assets/hamu.gif" alt="SNOWBALL"><img src="assets/hamu.gif" alt="IZZY"><img src="assets/hamu.gif" alt="BUD"><img src="assets/hamu.gif" alt="QUIRBY"><img src="assets/hamu.gif" alt="TINK"><img src="assets/hamu.gif" alt="NORBY"><img src="assets/hamu.gif" alt="MELONHEAD"><img src="assets/hamu.gif" alt="UNCLE EUGENE"><img src="assets/hamu.gif" alt="BOOG"><img src="assets/hamu.gif" alt="RHEAT1"><img src="assets/hamu.gif" alt="BEKY"><img src="assets/hamu.gif">
<img src="assets/anin.gif" alt="FIDGET,BONNIE,HENRY HOFFMAN"><img src="assets/anin.gif" alt="BOOTY SCOOTIN,              HEIDI"><img src="assets/anin.gif" alt="EVIL FRANSTER                    ELECTRA GLIDE"><img src="assets/anin.gif"><img src="assets/anin.gif" alt="HANS">
<img src="assets/gerbil.gif" alt="HAMPTON HAMPSTER"><img src="assets/gerbil.gif" alt="WEEZIE"><img src="assets/gerbil.gif" alt="ALEX"><img src="assets/gerbil.gif" alt="KRIS"><img src="assets/gerbil.gif" alt="GUSGUS"><img src="assets/gerbil.gif" alt="GEORGE THE TILTED HAMSTER"><img src="assets/gerbil.gif" alt="SHUSHU"><img src="assets/gerbil.gif" alt="LINKY"><img src="assets/gerbil.gif" alt="DINKY"><img src="assets/gerbil.gif" alt="PRINCESS ROSABELLE"><img src="assets/gerbil.gif" alt="HOLLAND"><img src="assets/gerbil.gif" alt="HADO HAMSTER">
<img src="assets/anin.gif" alt="SIR HAMLET, OLGA"><img src="assets/anin.gif" alt="PIGGIE"><img src="assets/anin.gif" alt="RATBOY"><img src="assets/anin.gif" alt="WOODY"><img src="assets/anin.gif">
<img src="assets/hamwalk.gif" alt="TINKY"><img src="assets/hamwalk.gif" alt="KATIE"><img src="assets/hamwalk.gif" alt="BUBBA"><img src="assets/hamwalk.gif" alt="ERLINE the GRAMMIE HAMSTER "><img src="assets/hamwalk.gif" alt="THUNDERFOOT"><img src="assets/hamwalk.gif"><img src="assets/hamwalk.gif"><img src="assets/hamwalk.gif"><img src="assets/hamwalk.gif"><img src="assets/hamwalk.gif"><img src="assets/hamwalk.gif"><img src="assets/hamwalk.gif"><img src="assets/hamwalk.gif"><img src="assets/hamwalk.gif">
<img src="assets/anin.gif"><img src="assets/anin.gif" alt="MONET, the WONDER BIRD"><img src="assets/anin.gif"><img src="assets/anin.gif"><img src="assets/anin.gif">
<img src="assets/hamu.gif"><img src="assets/hamu.gif"><img src="assets/hamu.gif"><img src="assets/hamu.gif" alt="HUEY"><img src="assets/hamu.gif" alt="SHARON"><img src="assets/hamu.gif" alt="PHYLLIS"><img src="assets/hamu.gif"><img src="assets/hamu.gif"><img src="assets/hamu.gif"><img src="assets/hamu.gif"><img src="assets/hamu.gif"><img src="assets/hamu.gif">
</p></center>
</section>

<style>
#giphy iframe {
	max-width: 100%;
	max-height: 70vh;
}
</style>
<section id=giphy>
	<h2>Memes</h2>
	<iframe src="https://giphy.com/" width=1000 height=700 sandbox></iframe>
</section>


<style>
#emoticons div {
	max-width: 100%;
	width: 780px;
}
#emoticons p {
	width: max-content;
	padding: 1ch;
}
#emoticons .d-l {
	border-radius: 1ch 1ch 1ch 0;
	background: #cccccc;
}
#emoticons .d-r {
	margin-left: auto;
	border-radius: 1ch 1ch 0 1ch;
	background: #0077cc;
	color: white;
}
</style>
<section id=emoticons>
	<h2>Emoticons</h2>
	<div>
	<p class=d-l>People still use GIFs‽
	<p class=d-r>More than ever.</p>
	<img src="assets/mind-blown.gif" alt="mind blown">
	</div>
</section>

<section id=ui>
	<h2>UI Elements</h2>
	<center>
		<img src="assets/check.gif" alt="animated checkbox" width=200><br>
		<img src="assets/music.gif" alt="animated music play button" width=150><br>
		<img src="assets/loading.gif" alt="loading" width=200><br>
		<img src="assets/like.gif" alt="Twitter like">
	<center>
</section>

<section id=wikipedia>
	<h2>Wikipedia</h2>
	<img src="assets/wikipedia.gif" alt="Rotating molecule of Benzatropine">
</section>

<style>
@font-face {
    font-family: "ExocetOTCECY-Medium";
    src: url("https://db.onlinewebfonts.com/t/1241ae66485548a9fed1d3c923f27761.eot");
    src: url("https://db.onlinewebfonts.com/t/1241ae66485548a9fed1d3c923f27761.eot?#iefix")format("embedded-opentype"),
    url("https://db.onlinewebfonts.com/t/1241ae66485548a9fed1d3c923f27761.woff2")format("woff2"),
    url("https://db.onlinewebfonts.com/t/1241ae66485548a9fed1d3c923f27761.woff")format("woff"),
    url("https://db.onlinewebfonts.com/t/1241ae66485548a9fed1d3c923f27761.ttf")format("truetype"),
    url("https://db.onlinewebfonts.com/t/1241ae66485548a9fed1d3c923f27761.svg#ExocetOTCECY-Medium")format("svg");
}
#bg div {
	font-family: "ExocetOTCECY-Medium";
	font-size: 2em;
	background: url("assets/circle.gif");
	background-size: 100% 100%;
	color: lightblue;
	text-shadow: blue 0px 0px 5px, white 0 0 10px;
	padding: 1em;
	display: flex;
    justify-content: center;
    align-items: center;
	text-align: center;
	aspect-ratio: 1/1;
	max-width: 30%;
	margin: auto;
}
</style>
<section id=bg>
	<h2>Decorative Images</h2>
	<div>New Game</div>
</section>

<link rel="stylesheet" href="https://richtexteditor.com/richtexteditor/rte_theme_default.css" />
<script type="text/javascript" src="https://richtexteditor.com/richtexteditor/rte.js"></script>
<script type="text/javascript" src='https://richtexteditor.com/richtexteditor/plugins/all_plugins.js'></script>
<style>
#rich aside {
	margin: 1em 0;
	border: solid 1px;
	border-radius: 5px;
	max-width: 30%;
	font-size: 16px;
}
#rich aside .titlebar {
	background: lightgray;
	text-align: center;
	font-size: 1.2em;
}
#rich aside img {
	width: 48px;
}
#rich figure {
	margin: 1em;
}
</style>
<section id=rich>
	<h2>Rich Text Editing</h2>
	<p>Drag&amp;drop inserts <code>&lt;img></code> tags<br>
	<aside>
		<div class=titlebar>/home/images</div>
		<figure>
			<img src="assets/w3c.gif" alt="Flaming W3C logo">
			<figcaption>logo.gif</figcaption>
		</figure>
	</aside>
	<div id="div_editor1">
		<p>Dear AC forum,
		<p>What do you think of this as a new logo:<br><br>
	</div>
</section>
<script>
	var editor1cfg = {}
	editor1cfg.toolbar = "basic";
	var editor1 = new RichTextEditor("#div_editor1", editor1cfg);
</script>

<section id=problem-users data-states=s1>
	<h2>Problem for Users</h2>
	<ul>
		<li><a href="https://www.w3.org/WAI/WCAG21/Understanding/pause-stop-hide.html">WCAG SC 2.2.2</a> violation: vestibular motion sensitivity, attention deficits
		<li>General preference/annoyance
	</ul>
	<div class=side-by-side data-visible-from=s1>
		<img src="assets/safari-setting.png" alt="Safari settings to turn off image animation" width=550>
		<img src="assets/firefox-setting.png" alt="Firefox settings to turn off image animation" width=550>
	</div>
</section>

<section id=problem-authors data-states="s1">
	<h2>Problem for Authors</h2>
	Accomodate user needs/preferences
	<ul>
		<li>Tailor adaptation to different uses of images
		<li>
	Different contexts:
		new content,
		old content,
		user-generated content,
		extensions…
	</ul>
	<div data-visible-from=s1>
	Evidence of author interest:
	<ul>
		<li>Stack overflow:
<a href="https://stackoverflow.com/questions/20644209/play-gif-on-mouseover-and-pause-gif-on-mouse-out-without-replacing-images">1</a>,
<a href="https://stackoverflow.com/questions/69593429/how-can-i-pause-and-play-gif-which-is-set-on-webpage-background">2</a>,
<a href="https://stackoverflow.com/questions/21872700/how-can-i-play-a-gif-like-9-gag">3</a>,
<a href="https://stackoverflow.com/questions/29661821/is-it-possible-to-pause-a-gif-image">4</a>,
<a href="https://stackoverflow.com/questions/5818003/stop-a-gif-animation-onload-on-mouseover-start-the-activation">5</a>;
Reddit:
<a href="https://old.reddit.com/r/HTML/comments/3hjccx/how_can_i_animate_and_stop_gifs_with_mouse_hover/">1</a>,
<a href="https://old.reddit.com/r/FirefoxCSS/comments/1523xwr/stop_animated_gifs_play_on_hoverclick/">2</a>…
<li>Quick polls by Lea: <a href="https://x.com/LeaVerou/status/1951457982916469028">X</a>,
<a href="https://front-end.social/@leaverou/114956605810091186">Mastodon</a>,
<a href="https://bsky.app/profile/lea.verou.me/post/3lvezoaigws2c">Bsky</a>
<li>CSS-WG github:
<a href="https://github.com/w3c/csswg-drafts/issues/1615" data-hovercard-type="issue" data-hovercard-url="/w3c/csswg-drafts/issues/1615/hovercard" aria-keyshortcuts="Alt+ArrowUp">issue 1615</a></li>
	</ul>
	</div>
</section>

<section id=workarounds>
	<h2>Workarounds</h2>
	<div class="side-by-side">
		<div>
			<h3>Server-side</h3>
			<ul>
				<li>Server-side frame extraction, then swapping out</li>
				<li>Server-side conversion to MP4, then using <code>&lt;video></code></li>

			</ul>
			<ul class="cons margin-start">
				<li>Computationally expensive</li>
			</ul>
		</div>
		<div>
			<h3>Client-side</h3>
			<ul>
				<li>Client-side frame extraction via <code>&lt;canvas></code>, then swapping out</li>
			</ul>
			<ul class="cons margin-start">
				<li>Same-origin only</li>
			</ul>
		</div>
	</div>
</section>

<section id=solutions>
	<h2>Solutions</h2>
</section>

<section id=paused data-states=s1>
	<h2>Idea: <code>image-animation</code> property</h2>

	<pre class="language-css"><code>
		image-animation: normal | paused | running
	</code></pre>


	<div class="side-by-side margin-start">
		<div>
			<p>
				Inherited, so you can do:
			</p>
			<pre class="language-css" style=min-width:max-content><code>
			@media (prefers-reduced-motion) {
			  :root {
			    image-animation: paused;
			  }
			}
			</code></pre>
		</div>
		<div data-visible-from=s1>
			Applies to:
			<ul>
				<li>Content images (<code>&lt;img></code>, <code>&lt;image></code> etc)</li>
				<li>CSS images (any <code>&lt;image></code> value)</li>
			</ul>
		</div>
	</div>

</section>

<section id=play>
	<h2>Toggling playback</h2>

	<div class="side-by-side">
		<div>
		<pre class="language-css"><code>
		@media (prefers-reduced-motion) {
		  :root {
		    image-animation: paused;
		  }

		  img:focus, img:hover {
		    image-animation: running;
		  }
		}
		</code></pre>
		<p>Focusability to be managed separately
		</div>
		<img src="assets/hover-play.gif" alt="Play">
	</div>
</section>

<section id=wpw>
	<h2>What authors want</h2>
	<img src="assets/wa-animated-image.gif" alt="Animated image with player">
</section>

<section id=img-in-video>
	<h2>Idea: Images in <code>&lt;video></code></h2>
	<pre><code class="language-html">&lt;video src="meme.gif" controls loop muted>&lt;/video></code></pre>
	<center><a href="https://github.com/webplatformco/explainers/blob/main/images-in-video/README.md">Explainer</a>, <a href="https://github.com/whatwg/html/issues/11554">WHATWG issue</a></center>
	<div class="side-by-side margin-start">
		<ul class="pros">
			<li>No new API surface</li>
			<li>Full playback control (user-facing UI, disabling loop, disabling autoplay, speed, etc)</li>
			<li>Extensibility built-in</li>
			<li>Initial reactions encouraging</li>
		</ul>
		<ul class="cons">
			<li>Need to switch element</li>
			<li>Can't respond to media queries (except with CAS)</li>
		</ul>
	</div>

</section>

<section id=img-controls>
	<h2>What about the opposite?</h2>
	<pre><code class="language-html">&lt;img src="meme.gif" controls noloop noautoplay></code></pre>
	<p>+ making <code>HTMLImageElement</code> implement <code>HTMLMediaElement</code></p>

	<ul class="cons columns">
		<li class="pros">Same element</li>
		<li class="pros">Tailored UI</li>
		<li data-reveal>Need to add HTML attributes <div>(but that can be solved with CAS)</div></li>
		<li>Can't respond to media queries (except with CAS)</li>
		<li>More new API surface</li>
		<li>API challenges</li>
		<li>Web compat challenges</li>
	</ul>
</section>

<section>
	<h2>Idea: High-level solution</h2>
	<div class="side-by-side">
		<img src="assets/wa-animated-image.gif" alt="Animated image with player">
		<div>
			<pre class="language-css"><code>
				image-animation: controlled;
			</code></pre>
			<ul class="margin-start">
				<li>Content images: UA-generated playback controls & automatic focusability</li>
				<li>CSS images: same as <code>paused</code></li>
				<li data-reveal>UA-generated UI <span>(customizable with pseudo-elements)</span></li>
				<li class="cons margin-start">tricky interaction with <code>&lt;img controls></code> if we ever decide to do it</li>
			</ul>
		</div>
	</div>
</section>

<section>
	<h2>Idea: Low-level solution</h2>
	<div class="side-by-side">
		<img src="assets/wa-animated-image.gif" alt="Animated image with player">
		<ul>
			<li>
				<code>img::overlay</code> pseudo-element to paint controls (or any other affordance)
			</li>
			<li>
				<code>img:static</code> pseudo-class to exclude static images
			</li>
			<li>
				<a href="https://github.com/explainers-by-googlers/scroll-triggered-animations/blob/main/CSS_PROPERTIES.md">Animation triggers</a> for playback control
			</li>
		</ul>
		<ul class="pros">
			<li>Primitives useful more broadly</li>
			<li>Compatible with future <code>&lt;img controls></code></li>
			<li class="cons">Simple things not easy</li>
			<li class="cons">Can make inaccessible interaction</li>
		</ul>
	</div>

</section>

<section id="other-ideas">
	<h2>Other ideas</h2>
</section>

<section>
	<h2><code>image-frame()</code> function</h2>
	<pre class="language-none"><code>image-frame(&lt;image> [at &lt;percentage> | last-shown]?)</code></pre>
	<div class="side-by-side margin-start">
		<ul class="pros">
			<li>Straightforward to implement</li>
			<li>Automatically upgrades all <code>&lt;image></code> values</li>
			<li>Can be granular</li>
		</ul>

		<ul class="cons">
			<li>More elaborate control over playback tricky</li>
			<li>Needs handshake with calling code</li>
		</ul>
	</div>
</section>

<section>
	<h2><code>animation-*</code> in <code>@image</code></h2>
	<p><small><a href="https://github.com/w3c/csswg-drafts/issues/6807#issuecomment-1248380039">WG resolution</a> for <code>@image</code> in 2022</small></p>
	<pre class="language-css"><code>
		@image --pause-if-reduced-motion {
			@media (prefers-reduced-motion) {
				animation-play-state: paused;
			}
		}

		.foo {
			background-image: image(url(foo.gif) --pause-if-reduced-motion)
		}
	</code></pre>
	<div class="side-by-side margin-start">
		<ul class="pros">
			<li>No new API surface</li>
			<li>Existing animation machinery for free</li>
		</ul>
		<ul class="cons">
			<li>Dependency on a much larger feature</li>
			<li>Needs handshake with calling code</li>
		</ul>
	</div>
</section>



<section>
	<h2>Special animation-name value</h2>
	<pre class="language-css"><code>
		animation-name: image-animation(content), image-animation(background-image);
		animation-play-state: paused;
	</code></pre>
	<div class="side-by-side margin-start">
		<ul class="pros">
			<li data-reveal>Granular</li>
			<li data-reveal>Can reuse existing animation controls
				<div>Including triggers, timelines etc</div>
			</li>
		</ul>
		<ul class="cons">
			<li>Weird</li>
			<li>No help with list-valued properties</li>
			<li>Awkward when combined with regular animations</li>
			<li>Needs explicit opt-in for every image-containing value</li>
		</ul>
	</div>
</section>

<section id=links>
	<h2>Links</h2>
	<p>Images in <code>&lt;video></code>: <a href="https://github.com/webplatformco/explainers/blob/main/images-in-video/README.md">Explainer</a>, <a href="https://github.com/whatwg/html/issues/11554">WHATWG issue</a>
	<p>CSS Image Animation in: <a href="https://github.com/webplatformco/explainers/blob/main/image-animation-property/README.md">Explainer</a>, <a href="https://github.com/w3c/csswg-drafts/issues/1615">CSSWG issue</a>
	<p><center><img src="assets/thanks.gif" alt="Thank you"></center>
</section>

<script>
	let slides = document.querySelectorAll("body > section");
	for (let i=1, slide; slide = slides[i]; i++) {
		if (!slide.id) {
			slide.id = `slide-${i}`;
		}
	}
</script>
